<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core">
    <style type="text/css">

        @media(min-width:1200px){
            .btn-editar,.btn-excluir {
                width: 40% !important;               
            }           
        }

    </style>

        <p:commandButton style="margin-top: 25px;width: auto" action="#{cadastroClienteBean.novoEndereco}"
                         styleClass="btn-adicionar-endereco" 
                     process="@this" update="frm:novoEnderecoDialog" 
                     oncomplete="PF('novoEnderecoDialog').show()"  id="endereco"  
                     icon="fa fa-plus" value="Adicionar endereço">
        <p:resetInput target="frm:novoEnderecoDialog"/>
    </p:commandButton>

    <p:dataTable id="tableEndereco" value="#{cadastroClienteBean.cliente.enderecos}" var="endereco" 
                 emptyMessage="O cliente não possui endereços" style="margin-top: 8px"  reflow="true">
        <p:column headerText="Logradouro" >
            <h:outputText value="#{endereco.logradouro}" />
        </p:column>
        <p:column headerText="Número"  >
            <h:outputText  value="#{endereco.numero}" />
        </p:column>
        <p:column headerText="Complemento"  >
            <h:outputText  value="#{endereco.complemento}" />
        </p:column>
        <p:column headerText="CEP" >
            <h:outputText  value="#{endereco.cep}" />
        </p:column>
        <p:column headerText="Cidade/UF" >
            <h:outputText  value="#{endereco.cidade}/#{endereco.uf}"/>
        </p:column>
        <p:column width="12%" >
            <p:button styleClass="btn-editar"    icon="fa fa-fw fa-edit" title="Editar" />
            <p:commandButton styleClass="btn-excluir" update=":frm:tableEndereco" process=":frm:tableEndereco" 
                             icon="fa fa-times" title="Excluir" >
                <p:collector value="#{endereco}" removeFrom="#{cadastroClienteBean.cliente.enderecos}" unique="false"/>
            </p:commandButton>
        </p:column>

    </p:dataTable>

    <p:dialog widgetVar="novoEnderecoDialog" id="novoEnderecoDialog" modal="true" showEffect="explode" 
               focus="cep" dynamic="true"  header="Inclusão de endereço" resizable="true" responsive="true">

        <h:panelGroup id="enderecoPanel" class="ui-fluid" layout="block">
            <p:messages autoUpdate="false" closable="true" />
            <p:panelGrid columns="2"  layout="grid" styleClass="panelgrid-noborder"
                         columnClasses="ui-grid-col-4, ui-grid-col-8">

                <p:outputLabel value="CEP" for="cep" />
                <p:inputText id="cep" value="#{cadastroClienteBean.endereco.cep}" />

                <p:outputLabel value="Logradouro" for="logradouro" />
                <p:inputText id="logradouro" value="#{cadastroClienteBean.endereco.logradouro}"  />

                <p:outputLabel value="Número" for="numero" />
                <p:inputText id="numero" value="#{cadastroClienteBean.endereco.numero}"  />

                <p:outputLabel value="complemento" for="complemento" />
                <p:inputText id="complemento"  value="#{cadastroClienteBean.endereco.complemento}"/>

                <p:outputLabel value="Cidade" for="cidade" />
                <p:inputText id="cidade" value="#{cadastroClienteBean.endereco.cidade}" />

                <p:outputLabel value="UF" for="uf" />
                <p:selectOneMenu id="uf" value="#{cadastroClienteBean.endereco.uf}" >
                    <f:selectItem  itemLabel="Selecione um estado" value="#{null}"  noSelectionOption="true"/> 
                    <f:selectItems value="#{cadastroClienteBean.ufs}" var="uf" itemValue="#{uf}" itemLabel="#{uf.valor}"  />
                </p:selectOneMenu>

                <p:outputLabel/>
                <p:commandButton  icon="fa fa-plus" value="Adicionar" process="novoEnderecoDialog"
                       oncomplete="if (!args.validationFailed) PF('novoEnderecoDialog').hide()"
                       update="frm:tableEndereco enderecoPanel">
                    <p:collector value="#{cadastroClienteBean.endereco}" 
                                 addTo="#{cadastroClienteBean.cliente.enderecos}" 
                                 unique="false"/>
                </p:commandButton>
            </p:panelGrid>
        </h:panelGroup>

    </p:dialog>

</ui:composition>
